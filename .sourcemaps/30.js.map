{"version":3,"sources":["../../src/pages/add-schedule/add-schedule.module.ts","../../src/pages/add-schedule/add-schedule.ts"],"names":[],"mappings":"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","file":"30.js","sourcesContent":["import { NgModule } from '@angular/core';\r\nimport { IonicPageModule } from 'ionic-angular';\r\nimport { AddSchedulePage } from './add-schedule';\r\n\r\n@NgModule({\r\n  declarations: [\r\n    AddSchedulePage,\r\n  ],\r\n  imports: [\r\n    IonicPageModule.forChild(AddSchedulePage),\r\n  ],\r\n  exports: [\r\n    AddSchedulePage\r\n  ]\r\n})\r\nexport class AddSchedulePageModule {}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/add-schedule/add-schedule.module.ts","import { Component, ViewChild, ElementRef, Renderer } from '@angular/core';\r\nimport { NavController, ViewController, ModalController, NavParams, Tabs, AlertController, App, IonicPage } from 'ionic-angular';\r\nimport { AngularFireAuth } from 'angularfire2/auth';\r\nimport { AngularFireDatabase } from 'angularfire2/database';\r\nimport { SignUpService } from '../../services/signup.service';\r\nimport { sendCoordsService } from '../../services/sendCoords.service';\r\n\r\nimport { sendUsersService } from '../../services/sendUsers.service';\r\nimport { priceService } from '../../services/price.service';\r\nimport { geofireService } from '../../services/geofire.services';\r\nimport { Subscription, Subject, Subscriber } from 'rxjs';\r\nimport * as moment from 'moment';\r\nimport { MetricsService } from '../../services/metrics.service';\r\nimport { instancesService } from '../../services/instances.service';\r\n\r\n \r\n\r\n@IonicPage()\r\n@Component({\r\n  selector: 'page-add-schedule',\r\n  templateUrl: 'add-schedule.html',\r\n})\r\nexport class AddSchedulePage {\r\n  @ViewChild('house',{read:ElementRef}) house;\r\n  @ViewChild('work',{read:ElementRef}) work;\r\n  accepted:any;\r\n  imageHouseToWork:boolean = false;\r\n  imageWorkToHouse:boolean = false;\r\n  button1WasntTapped:boolean = true;\r\n  button2WasntTapped:boolean = true;\r\n  textMessage: string;\r\n  startHour:any;\r\n  userId: any;\r\n  geofireType:string;\r\n  imageURL:any;\r\n  constructor(public navCtrl: NavController, public navParams: NavParams, public viewCtrl: ViewController,public renderer: Renderer ,public alertCtrl: AlertController, public signUpService: SignUpService, public angularFireAuth: AngularFireAuth, private instances: instancesService, private afDB: AngularFireDatabase) {\r\n  \r\n    this.userId = this.angularFireAuth.auth.currentUser.uid;\r\n  }\r\n\r\n  ionViewDidLoad() {\r\n    console.log('ionViewDidLoad AddSchedulePage');\r\n  }\r\n\r\n\r\n  dismiss(){\r\n    this.viewCtrl.dismiss(this.accepted);\r\n\r\n  }\r\n\r\n  \r\n  selectImageHouse(){\r\n    // this is just to change the css\r\n    this.renderer.setElementStyle(this.house.nativeElement,'border-width','3px')\r\n    this.renderer.setElementStyle(this.house.nativeElement,'border-style','solid')\r\n    this.renderer.setElementStyle(this.house.nativeElement,'border-color','green')\r\n  \r\n    this.renderer.setElementStyle(this.work.nativeElement,'border-width','0px')\r\n    this.imageURL = 'assets/imgs/houseToWork.png';\r\n\r\n    this.textMessage = 'Trabajo'\r\n    this.geofireType = 'origin';\r\n    this.imageHouseToWork = true;\r\n    this.imageWorkToHouse = false;\r\n  }\r\n  selectImageWork(){\r\n    // this is just to change the css\r\n    this.renderer.setElementStyle(this.work.nativeElement,'border-width','3px')\r\n    this.renderer.setElementStyle(this.work.nativeElement,'border-style','solid')\r\n    this.renderer.setElementStyle(this.work.nativeElement,'border-color','green')\r\n  \r\n    this.renderer.setElementStyle(this.house.nativeElement,'border-width','0px')\r\n    this.textMessage = 'Casa';\r\n    this.geofireType = 'destination';\r\n    this.imageURL = 'assets/imgs/workToHouse.png';\r\n    this.imageHouseToWork = false;\r\n    this.imageWorkToHouse = true;\r\n  \r\n  }\r\n \r\n\r\n  confirm(){\r\n    console.log(this.imageHouseToWork);\r\n    console.log(this.imageWorkToHouse);\r\n\r\n    this.afDB.database.ref(this.signUpService.userPlace + '/drivers/' + this.userId + '/scheduleType/').once('value').then((snap)=>{\r\n      if(snap.val() === 'picture'){\r\n        const alert = this.alertCtrl.create({\r\n          title: 'Ya haz enviado FOTO de tu horario',\r\n          subTitle: '¿deseas crear tu horario personalizado? Perderás los horarios creados automaticamente por la foto', \r\n          buttons: [\r\n            {\r\n              text: 'No',\r\n              handler: (()=>{\r\n                this.viewCtrl.dismiss();\r\n              }),\r\n              role: 'cancel'\r\n          },\r\n          {\r\n            text: 'Si',\r\n            handler: (()=>{\r\n              this.afDB.database.ref(this.signUpService.userPlace + '/drivers/' + this.userId + '/schedule/').remove().then(()=>{\r\n                if(this.imageHouseToWork === true  || this.imageWorkToHouse === true){ \r\n                  if(this.startHour === undefined || this.startHour === null){\r\n                    const alert = this.alertCtrl.create({\r\n                      title: 'Debes seleccionar una hora de partida',\r\n                      subTitle: '¿A qué hora sales del trabajo o de tu casa?',\r\n                      buttons: ['OK']\r\n                    });\r\n                    alert.present();\r\n                  }else{\r\n                    const alert = this.alertCtrl.create({\r\n                      title: '¿vas de tu ' + this.textMessage + ' a las ' + this.startHour + '?',\r\n                      buttons: [\r\n                        {\r\n                          text: 'Confirmo este horario',\r\n                          handler: () => {\r\n                            this.signUpService.pushSchedule(this.signUpService.userPlace, this.userId, this.startHour, this.geofireType, this.textMessage, this.imageURL );\r\n                            this.instances.scheduleTypeManual(this.signUpService.userPlace, this.userId);\r\n                            this.viewCtrl.dismiss();\r\n                          }\r\n                        }\r\n                      ]\r\n                    });\r\n                    alert.present();\r\n                  }\r\n                  \r\n                }else{\r\n                  const alert = this.alertCtrl.create({\r\n                    title: 'Debes seleccionar una opción',\r\n                    subTitle: '¿a esta hora vas de tu trabajo a tu casa o de tu casa a tu trabajo?',\r\n                    buttons: ['OK']\r\n                  });\r\n                  alert.present();\r\n                }\r\n              })\r\n            })\r\n          }\r\n        ]\r\n        });\r\n        alert.present();\r\n      }else{\r\n        if(this.imageHouseToWork === true  || this.imageWorkToHouse === true){ \r\n          if(this.startHour === undefined || this.startHour === null){\r\n            const alert = this.alertCtrl.create({\r\n              title: 'Debes seleccionar una hora de partida',\r\n              subTitle: '¿A qué hora sales del trabajo o de tu casa?',\r\n              buttons: ['OK']\r\n            });\r\n            alert.present();\r\n          }else{\r\n            const alert = this.alertCtrl.create({\r\n              title: '¿vas de tu ' + this.textMessage + ' a las ' + this.startHour + '?',\r\n              buttons: [\r\n                {\r\n                  text: 'Confirmo este horario',\r\n                  handler: () => {\r\n                    this.signUpService.pushSchedule(this.signUpService.userPlace, this.userId, this.startHour, this.geofireType, this.textMessage, this.imageURL );\r\n                    this.viewCtrl.dismiss();\r\n                  }\r\n                }\r\n              ]\r\n            });\r\n            alert.present();\r\n          }\r\n          \r\n        }else{\r\n          const alert = this.alertCtrl.create({\r\n            title: 'Debes seleccionar una opción',\r\n            subTitle: '¿a esta hora vas de tu trabajo a tu casa o de tu casa a tu trabajo?',\r\n            buttons: ['OK']\r\n          });\r\n          alert.present();\r\n        }\r\n      }\r\n    })\r\n  }\r\n\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/add-schedule/add-schedule.ts"],"sourceRoot":""}