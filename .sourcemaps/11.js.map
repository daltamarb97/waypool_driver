{"version":3,"sources":["../../src/pages/pickup/pickup.module.ts","../../src/pages/pickup/pickup.ts"],"names":[],"mappings":"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","file":"11.js","sourcesContent":["\r\nimport { NgModule } from '@angular/core';\r\nimport { IonicPageModule } from 'ionic-angular';\r\nimport { PickupPage } from './pickup';\r\n \r\n@NgModule({\r\n  declarations: [\r\n    PickupPage,\r\n  ],\r\n  imports: [\r\n    IonicPageModule.forChild(PickupPage),\r\n  ],\r\n  exports: [\r\n    PickupPage\r\n  ]\r\n})\r\nexport class PickupPageModule {}\n\n\n// WEBPACK FOOTER //\n// ./src/pages/pickup/pickup.module.ts","import { Component, NgZone, ElementRef, ViewChild } from '@angular/core';\r\nimport { NavController, NavParams, AlertController, ToastController, IonicPage } from 'ionic-angular';\r\n\r\nimport { sendCoordsService } from '../../services/sendCoords.service';\r\nimport { AngularFireAuth } from 'angularfire2/auth';\r\nimport { SignUpService } from '../../services/signup.service';\r\nimport { authenticationService } from '../../services/driverauthentication.service';\r\nimport { Geolocation } from '@ionic-native/geolocation';\r\nimport * as firebase from 'Firebase';\r\nimport { CallNumber } from '@ionic-native/call-number';\r\nimport * as moment from 'moment';\r\nimport { geofireService } from '../../services/geofire.services';\r\nimport { TripsService } from '../../services/trips.service';\r\n\r\ndeclare var google; \r\n@IonicPage()\r\n@Component({\r\n  selector: 'page-pickup',\r\n  templateUrl: 'pickup.html'\r\n})\r\nexport class PickupPage {\r\n  @ViewChild('map') mapElement: ElementRef;\r\n  map: any;\r\n  markers:any;\r\n  user:any;\r\n  directionsService: any = null;\r\n  directionsDisplay: any = null;\r\n  bounds: any = null;\r\n  myLatLng:any;\r\n  destinationOnTrip:any;\r\n  geocoder:any;\r\n  addressOrigin:any;\r\n  updatelocation:any;\r\n  useruid=this.AngularFireAuth.auth.currentUser.uid;\r\n  userDriver:any;\r\n  userFirebase:any;\r\n  keyTrip:string;\r\n  constructor(public navCtrl: NavController,public alertCtrl: AlertController,public TripsService:TripsService,public toastCtrl: ToastController,private callNumber: CallNumber,public navParams: NavParams,public SignUpService:SignUpService,private authenticationService:authenticationService, public geolocation: Geolocation,public zone: NgZone, public sendCoordsService: sendCoordsService, private AngularFireAuth: AngularFireAuth) {\r\n    this.markers = [];\r\n    //we get the info of the users with navParams\r\n    this.user= this.navParams.get('user') \r\n    this.keyTrip= this.navParams.get('keyTrip') \r\n    console.log(this.user)\r\n    console.log(this.keyTrip)\r\n\r\n    this.directionsService = new google.maps.DirectionsService();\r\n    this.directionsDisplay = new google.maps.DirectionsRenderer({\r\n      suppressMarkers: true,\r\n  });\r\n    this.bounds = new google.maps.LatLngBounds();\r\n    this.geocoder = new google.maps.Geocoder();\r\n\r\n    this.SignUpService.getMyInfoDriver(this.useruid)\r\n\t\t.subscribe(userDriver => {\r\n\t\t\tthis.userDriver = userDriver;\r\n\t\t\tconsole.log(this.userDriver);\r\n\t\t});\r\n    this.SignUpService.getInfoUser(this.user.userId)\r\n\t\t.subscribe(userFirebase => {\r\n      //modificar\r\n      //get info user and observe if user has not canceled\r\n      this.userFirebase = userFirebase;\r\n\r\n    // if(this.userFirebase.trips.onTrip === true ){\r\n\r\n    // } else {\r\n    //   //if canceled go back to myRidePage\r\n    //   this.navCtrl.pop();\r\n    //   const toast = this.toastCtrl.create({\r\n    //     message: `El estudiante ${this.user.name} que ibas a recoger te ha cancelado`,\r\n    //     showCloseButton:true,\r\n    //     closeButtonText: 'OK',\r\n    //     position:'middle'\r\n    //        });\r\n    //   toast.present();\r\n    // }\r\n\t\t\t\r\n\t\t});\r\n  }\r\n  ionViewDidLoad(){\r\n    \r\n    this.loadMap();\r\n  \r\n  }\r\n \r\n  loadMap(){\r\n\r\n // this gets current position and set the camera of the map and put a marker in your location\r\n    \r\n    this.geolocation.getCurrentPosition({enableHighAccuracy: true}).then((position) => {\r\n\r\n      let latLng = new google.maps.LatLng(position.coords.latitude, position.coords.longitude);\r\n \r\n      let mapOptions = {\r\n          center: latLng,\r\n          zoom: 17,\r\n          mapTypeId: google.maps.MapTypeId.ROADMAP,\r\n          \r\n            zoomControl: false,\r\n            mapTypeControl: false,\r\n            scaleControl: false,\r\n            streetViewControl: false,\r\n            rotateControl: false,\r\n            fullscreenControl: false,\r\n           \r\n            styles: [\r\n              {\r\n                featureType: 'poi',\r\n                elementType: 'labels.icon',\r\n                stylers: [\r\n                  {\r\n                    visibility: 'off'\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          \r\n        }\r\n\r\n        this.myLatLng = {lat: position.coords.latitude , lng: position.coords.longitude};\r\n    //creates the map and give options\r\n      this.map = new google.maps.Map(this.mapElement.nativeElement, mapOptions);\r\n      this.geocodeLatLng(latLng)\r\n\r\n      let marker = new google.maps.Marker({\r\n        map: this.map,\r\n        animation: google.maps.Animation.DROP,\r\n        position: latLng,\r\n        icon: {         url: \"assets/imgs/marker-origin-driver.png\",\r\n        scaledSize: new google.maps.Size(90, 90)    \r\n\r\n      }\r\n      \r\n        \r\n      });\r\n      this.markers.push(marker);   \r\n      },(err) => {\r\n      console.log(err);    \r\n     });\r\n     //transform the position of the user into an adress\r\n    this.geocodeAddress(this.user.origin)\r\n\r\n    // watch: track the position of the user\r\n  //   let watch = this.geolocation.watchPosition();\r\n  //   watch.subscribe((data) => {\r\n  //   this.deleteMarkers();\r\n  //   this.updatelocation = new google.maps.LatLng(data.coords.latitude,data.coords.longitude);\r\n  //   this.geocodeLatLng(this.updatelocation);\r\n  //   console.log(this.updatelocation)\r\n    \r\n  //   this.sendCoordsService.updateGeolocationOrigin(this.useruid,this.addressOrigin)\r\n    \r\n  //   this.addMarker(this.updatelocation);\r\n  //   this.setMapOnAll(this.map); //nose de esta funcion\r\n  // });   \r\n  }\r\n   geocodeAddress(userOrigin) {\r\n    this.geocoder.geocode({'address':JSON.stringify(userOrigin)}, (results, status) =>  {\r\n      if (status == 'OK') {\r\n     \r\n        \r\n        var marker = new google.maps.Marker({\r\n          map: this.map,\r\n          position: results[0].geometry.location,\r\n          icon: {         url: \"assets/imgs/marker-destination2.png\",\r\n          scaledSize: new google.maps.Size(90, 90)     \r\n        }\r\n        });\r\n      \r\n        this.directionsDisplay.setMap(this.map);\r\n        this.calculateRoute(results[0].geometry.location)\r\n      } else {\r\n        alert('Geocode was not successful for the following reason: ' + status);\r\n      }\r\n      \r\n    });\r\n    \r\n  }\r\n  geocodeLatLng(latLng) {\r\n\r\n    this.geocoder.geocode({'location': latLng}, (results, status) => {\r\n      if (status === 'OK') {\r\n        if (results[0]) {\r\n           this.addressOrigin= results[0].formatted_address\r\n        } else {\r\n         alert('No results found');\r\n        }\r\n      } else {\r\n        alert('Geocoder failed due to: ' + status);\r\n      }\r\n                  \r\n  \r\n    });\r\n  } \r\n  calculateRoute(destinationOnTrip){\r\n    //tutorial ngclassroom https://blog.ng-classroom.com/blog/ionic2/directions-google-js-ionic/\r\n\r\n    this.bounds.extend(this.myLatLng);\r\n\r\n    \r\n  \r\n    this.map.fitBounds(this.bounds);\r\n    \r\n    this.directionsService.route({\r\n     origin: new google.maps.LatLng(this.myLatLng.lat, this.myLatLng.lng),\r\n      destination: destinationOnTrip,\r\n      travelMode: google.maps.TravelMode.DRIVING,\r\n      avoidTolls: true\r\n    }, (response, status)=> {\r\n      //render\r\n      if(status === google.maps.DirectionsStatus.OK) {\r\n        this.directionsDisplay.setDirections(response);\r\n      }else{\r\n        alert('Could not display directions due to: ' + status);\r\n      }\r\n      \r\n    });  \r\n    \r\n    \r\n  }\r\n\r\n\r\n   \r\n    addMarker(location) {\r\n      let marker = new google.maps.Marker({\r\n        position: location,\r\n        map: this.map,\r\n        // icon: image\r\n      });\r\n      this.markers.push(marker);\r\n    }\r\n    \r\n    setMapOnAll(map) {\r\n      for (var i = 0; i < this.markers.length; i++) {\r\n        this.markers[i].setMap(map);\r\n      }\r\n    }\r\n    \r\n    clearMarkers() {\r\n      this.setMapOnAll(null);\r\n    }\r\n    \r\n    deleteMarkers() {\r\n      this.clearMarkers();\r\n      this.markers = [];\r\n    }\r\n    \r\n    notifyDriver(){\r\n      this.presentToast(`Se le ha notificado a ${this.user.name} que ya llegaste`,3000,'top');\r\n    }\r\n    PickUp(){\r\n      \r\n      this.TripsService.eliminatePendingUsers(this.keyTrip,this.useruid,this.user.userId);\r\n\r\n      // this.sendCoordsService.pushPriceOnUser(this.useruid,this.user.userId,this.userDriver.trips.price)\r\n\r\n      this.TripsService.pickUp(this.keyTrip,this.useruid,this.user.userId,this.user);\r\n      this.presentToast(`Acabas de recoger a ${this.user.name}, ¡Salúdalo por nosotros!`,4000,'top');\r\n      // this.sendCoordsService.pickUpInstance(this.user.userId);\r\n      // moment.locale('es');   \r\n      // let currDate = moment().format('MMMM Do YYYY, h:mm:ss a');\r\n      //   this.sendCoordsService.timeOfPickedUpDriver(this.useruid,currDate,this.user.userId)\r\n      //   this.sendCoordsService.timeOfPickedUpUser(this.user.userId,currDate)\r\n\r\n    }\r\n    \r\n    callUser(){\r\n    \r\n      this.callNumber.isCallSupported()\r\n    .then((response) => {\r\n    if (response == true) {\r\n      this.callNumber.callNumber(this.user.phone, true)\r\n      .then(res => console.log('Launched dialer!', res)) //si no es necesario esta promesa, eliminarla\r\n      .catch(err => console.log('Error launching dialer', err));\r\n    }\r\n    else {\r\n        this.presentAlert('Error','No se pudo generar la llamada','ok');\r\n          }\r\n      });\r\n    }\r\n    presentToast(message:string,duration,position:string) {     \r\n      const toast = this.toastCtrl.create({\r\n        message: message,\r\n        duration: duration,\r\n        position:position\r\n      });\r\n      toast.present();\r\n    }\r\n    presentAlert(title:string,text:string,button:string) {\r\n      let alert = this.alertCtrl.create({\r\n        title: title,\r\n        subTitle: text,\r\n        buttons: [button]\r\n      });\r\n      alert.present();\r\n    }\r\n    help(){\r\n      const toast = this.toastCtrl.create({\r\n        message: 'En esta página podrás ver mejor la dirección que de tu compañer@s a través de un mapa, cuando hayas llegado al lugar donde está tu compañer@, cada vez que presiones el botón \"Ya llegué\" se le enviará una notificación al estudiante de que ya llegaste. ¡Que disfruten el viaje!',\r\n        showCloseButton:true,\r\n        closeButtonText: 'OK',\r\n        position:'top'\r\n           });\r\n      toast.present();\r\n    }\r\n\r\n    more(){\r\n      \r\n    }\r\n  }\r\n    \r\n\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/pickup/pickup.ts"],"sourceRoot":""}